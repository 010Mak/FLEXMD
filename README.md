# flexMD (MMD/MMDFLED)

## API Example

### Methane 

```bash

(MMDFLED-Server) mak@DESKTOP-V7E8UM6:/mnt/e/MMDFLED$ ./scripts/everything.sh
=== meta ===
{
  "backend_requested": "auto",
  "n_atoms": 5,
  "n_steps": 5,
  "report_stride": 1,
  "report_stride_was_adjusted": false,
  "selected_backend": "psi4",
  "timestep_ps": 0.0005,
  "units": {
    "energy": "kcal/mol",
    "force": "kcal/mol/angstrom",
    "length": "angstrom",
    "time": "ps"
  }
}

=== atoms (elements only) ===
[
  {
    "element": "C"
  },
  {
    "element": "H"
  },
  {
    "element": "H"
  },
  {
    "element": "H"
  },
  {
    "element": "H"
  }
]

=== atom_radii_A (space-fill vdw radii) ===
[
  1.7,
  1.1,
  1.1,
  1.1,
  1.1
]

=== identity (formula, names, etc) ===
{
  "display_name": "CH₄",
  "formula": "CH4",
  "formula_pretty": "CH₄",
  "fragment_count": 1,
  "has_3d": true,
  "inchi": "InChI=1S/CH4/h1H4",
  "inchikey": "VNWKTOKETHGBQD-UHFFFAOYSA-N",
  "input_type": "atoms",
  "issues": [],
  "name_source": "computed",
  "net_charge": 0,
  "smiles": "[H]C([H])([H])[H]",
  "species_kind": "molecule",
  "spin_multiplicity": 1
}

=== trajectory summary ===
{
  "n_frames": 5,
  "steps": [
    1,
    2,
    3,
    4,
    5
  ],
  "times_ps": [
    0.0005,
    0.001,
    0.0015,
    0.002,
    0.0025
  ],
  "energies_kcalmol": [
    -24928.988079620565,
    -24928.988079620984,
    -24928.988079620984,
    -24928.988079621013,
    -24928.988079620565
  ]
}

=== first frame ===
{
  "energy": -24928.988079620565,
  "forces": [
    [
      4.789493062213643e-25,
      -0,
      -1.2905890255052377e-08
    ],
    [
      -5.5105454516121934,
      -1.687117962814125e-16,
      -3.896544048971142
    ],
    [
      -1.687117961916095e-16,
      5.510545444525105,
      3.8965440554254918
    ],
    [
      1.6871179583239753e-16,
      -5.510545444525105,
      3.8965440554254918
    ],
    [
      5.5105454516121934,
      1.6871179616167517e-16,
      -3.896544048971142
    ]
  ],
  "positions": [
    [
      -2.606886262111539e-31,
      2.606886262111539e-31,
      2.2092815619337538e-14
    ],
    [
      0.628714085749973,
      0.629,
      0.6287978280951217
    ],
    [
      0.629,
      -0.6287140857502556,
      -0.6287978280952534
    ],
    [
      -0.629,
      0.6287140857502556,
      -0.6287978280952534
    ],
    [
      -0.628714085749973,
      -0.629,
      0.6287978280951217
    ]
  ],
  "step": 1,
  "time_ps": 0.0005,
  "velocities": [
    [
      -0.03539646225455589,
      0.09385096300989905,
      0.0590709075887212
    ],
    [
      -1.4605733049563354,
      -0.8324869827081344,
      -1.299165828201461
    ],
    [
      0.6136900467844051,
      1.0026679818439206,
      0.8844101052400328
    ],
    [
      0.46511399391406444,
      -1.0603843476310517,
      0.21834847199759194
    ],
    [
      0.9311091209324251,
      0.29809773329131795,
      -1.5287684217998012
    ]
  ]
}

=== last frame ===
{
  "energy": -24928.988079620565,
  "forces": [
    [
      5.986866327767053e-26,
      -0,
      4.793358774739836e-09
    ],
    [
      -5.5105460879652215,
      -1.687118157162773e-16,
      -3.896544503585234
    ],
    [
      -1.6871181560402357e-16,
      5.510546083954952,
      3.8965445011894695
    ],
    [
      1.6871181555912208e-16,
      -5.510546083954952,
      3.8965445011894695
    ],
    [
      5.5105460879652215,
      1.6871181569382656e-16,
      -3.896544503585234
    ]
  ],
  "positions": [
    [
      -0.00033535501338896264,
      0.00019445851368473266,
      2.4237757553582465e-05
    ],
    [
      0.6198538248125506,
      0.6278348427332795,
      0.6239256873947338
    ],
    [
      0.629712057317103,
      -0.6224794257325066,
      -0.6243498978544924
    ],
    [
      -0.6269958401692594,
      0.6211775190324442,
      -0.6270127770904208
    ],
    [
      -0.62096242721796,
      -0.6273395871195871,
      0.6219763739596431
    ]
  ],
  "step": 5,
  "time_ps": 0.0025,
  "velocities": [
    [
      -0.08505623269218049,
      0.0635349711730197,
      -0.07625540126471884
    ],
    [
      -7.336083588728951,
      -0.21854107041845863,
      -3.2148244014660246
    ],
    [
      -1.2939889931331372,
      5.1978773885575515,
      3.516200754548088
    ],
    [
      2.4099191252155903,
      -6.057149550284622,
      2.752270573591639
    ],
    [
      7.344574321711881,
      1.5567232320490358,
      -4.60274534287386
    ]
  ]
}

=== full json (everything) ===
{
  "atom_radii_A": [
    1.7,
    1.1,
    1.1,
    1.1,
    1.1
  ],
  "atoms": [
    {
      "element": "C"
    },
    {
      "element": "H"
    },
    {
      "element": "H"
    },
    {
      "element": "H"
    },
    {
      "element": "H"
    }
  ],
  "identity": {
    "display_name": "CH₄",
    "formula": "CH4",
    "formula_pretty": "CH₄",
    "fragment_count": 1,
    "has_3d": true,
    "inchi": "InChI=1S/CH4/h1H4",
    "inchikey": "VNWKTOKETHGBQD-UHFFFAOYSA-N",
    "input_type": "atoms",
    "issues": [],
    "name_source": "computed",
    "net_charge": 0,
    "smiles": "[H]C([H])([H])[H]",
    "species_kind": "molecule",
    "spin_multiplicity": 1
  },
  "meta": {
    "backend_requested": "auto",
    "n_atoms": 5,
    "n_steps": 5,
    "report_stride": 1,
    "report_stride_was_adjusted": false,
    "selected_backend": "psi4",
    "timestep_ps": 0.0005,
    "units": {
      "energy": "kcal/mol",
      "force": "kcal/mol/angstrom",
      "length": "angstrom",
      "time": "ps"
    }
  },
  "status": "success",
  "trajectory": [
    {
      "energy": -24928.988079620565,
      "forces": [
        [
          4.789493062213643e-25,
          -0,
          -1.2905890255052377e-08
        ],
        [
          -5.5105454516121934,
          -1.687117962814125e-16,
          -3.896544048971142
        ],
        [
          -1.687117961916095e-16,
          5.510545444525105,
          3.8965440554254918
        ],
        [
          1.6871179583239753e-16,
          -5.510545444525105,
          3.8965440554254918
        ],
        [
          5.5105454516121934,
          1.6871179616167517e-16,
          -3.896544048971142
        ]
      ],
      "positions": [
        [
          -2.606886262111539e-31,
          2.606886262111539e-31,
          2.2092815619337538e-14
        ],
        [
          0.628714085749973,
          0.629,
          0.6287978280951217
        ],
        [
          0.629,
          -0.6287140857502556,
          -0.6287978280952534
        ],
        [
          -0.629,
          0.6287140857502556,
          -0.6287978280952534
        ],
        [
          -0.628714085749973,
          -0.629,
          0.6287978280951217
        ]
      ],
      "step": 1,
      "time_ps": 0.0005,
      "velocities": [
        [
          -0.03539646225455589,
          0.09385096300989905,
          0.0590709075887212
        ],
        [
          -1.4605733049563354,
          -0.8324869827081344,
          -1.299165828201461
        ],
        [
          0.6136900467844051,
          1.0026679818439206,
          0.8844101052400328
        ],
        [
          0.46511399391406444,
          -1.0603843476310517,
          0.21834847199759194
        ],
        [
          0.9311091209324251,
          0.29809773329131795,
          -1.5287684217998012
        ]
      ]
    },
    {
      "energy": -24928.988079620984,
      "forces": [
        [
          -8.98029949165058e-26,
          -0,
          -1.467100300353236e-08
        ],
        [
          -5.510546776167052,
          -1.6871183679753036e-16,
          -3.896544998983799
        ],
        [
          -1.687118365131542e-16,
          5.510546768654067,
          3.896545006323364
        ],
        [
          1.6871183657302289e-16,
          -5.510546768654067,
          3.896545006323364
        ],
        [
          5.510546776167052,
          1.6871183675262886e-16,
          -3.896544998983799
        ]
      ],
      "positions": [
        [
          -1.7698231127277943e-05,
          4.692548150494953e-05,
          2.953545376025676e-05
        ],
        [
          0.6276978848840828,
          0.628583756508646,
          0.6279460733022897
        ],
        [
          0.6293068450233922,
          -0.6279268375462893,
          -0.6281534511635671
        ],
        [
          -0.628767443003043,
          0.6278979793633958,
          -0.6284864819801884
        ],
        [
          -0.6279626169760948,
          -0.6288509511333543,
          0.6278312720054905
        ]
      ],
      "step": 2,
      "time_ps": 0.001,
      "velocities": [
        [
          -0.23292011722378375,
          -0.09980388215972538,
          0.12410233037396565
        ],
        [
          -2.6875643161281824,
          -1.1130643931696238,
          -1.9151368974901368
        ],
        [
          0.5955372382112737,
          2.2867802780325475,
          1.965817419781555
        ],
        [
          0.9407848262025185,
          -2.0933187992026374,
          -0.4207205915244328
        ],
        [
          2.2032930137240814,
          0.9038757593629467,
          -3.00204810218446
        ]
      ]
    },
    {
      "energy": -24928.988079620984,
      "forces": [
        [
          2.3947465311068213e-25,
          -0,
          -3.7239160042411528e-09
        ],
        [
          -5.510546179001271,
          -1.687118185226209e-16,
          -3.896544567548888
        ],
        [
          -1.687118183542403e-16,
          5.51054617087054,
          3.8965445694146355
        ],
        [
          1.6871181813347459e-16,
          -5.51054617087054,
          3.8965445694146355
        ],
        [
          5.510546179001271,
          1.6871181843281792e-16,
          -3.896544567548888
        ]
      ],
      "positions": [
        [
          -0.00013415828973916983,
          -2.976459574913166e-06,
          9.158661888335702e-05
        ],
        [
          0.6260681884438823,
          0.6280272243120611,
          0.626786332925522
        ],
        [
          0.6296046136424979,
          -0.6264975331255264,
          -0.6269683705252729
        ],
        [
          -0.6282970505899418,
          0.6265654056820478,
          -0.6284946703475471
        ],
        [
          -0.6265750561870963,
          -0.6283990132536729,
          0.6261280760263755
        ]
      ],
      "step": 3,
      "time_ps": 0.0015,
      "velocities": [
        [
          -0.2685420946582946,
          0.20587818572838734,
          0.008537134023046495
        ],
        [
          -5.114692987847205,
          -0.40848996312552843,
          -2.0956697425388997
        ],
        [
          0.10387531434378909,
          2.842297182614154,
          1.3905330910199818
        ],
        [
          1.3364352067162903,
          -3.9314004556443867,
          0.5401193232672267
        ],
        [
          4.366270395288064,
          0.9685622511540539,
          -3.4396163055705165
        ]
      ]
    },
    {
      "energy": -24928.988079621013,
      "forces": [
        [
          5.986866327767053e-26,
          -0,
          4.793358774739836e-09
        ],
        [
          -5.5105460879652215,
          -1.687118157162773e-16,
          -3.896544503585234
        ],
        [
          -1.6871181560402357e-16,
          5.510546083954952,
          3.8965445011894695
        ],
        [
          1.6871181555912208e-16,
          -5.510546083954952,
          3.8965445011894695
        ],
        [
          5.5105460879652215,
          1.6871181569382656e-16,
          -3.896544503585234
        ]
      ],
      "positions": [
        [
          -0.0002684293370683171,
          9.99626332892805e-05,
          9.585518587866506e-05
        ],
        [
          0.6232249276988062,
          0.6278229793304984,
          0.6255363261486149
        ],
        [
          0.6296565512996698,
          -0.6247904702834886,
          -0.6260709320740284
        ],
        [
          -0.6276288329865837,
          0.6243137912034948,
          -0.628022438780179
        ],
        [
          -0.6241060067382997,
          -0.6279147321280958,
          0.6242060959679526
        ]
      ],
      "step": 4,
      "time_ps": 0.002,
      "velocities": [
        [
          -0.13385135264129114,
          0.1889917607909043,
          -0.14323485669190905
        ],
        [
          -6.170377279652892,
          0.023726805562297597,
          -2.8169337031243376
        ],
        [
          0.11101203486650198,
          4.050260609521804,
          3.0377246346828115
        ],
        [
          1.2659856346487013,
          -5.700715849659073,
          1.6149795751270988
        ],
        [
          5.715330547821069,
          1.1502900170173052,
          -4.055100211981134
        ]
      ]
    },
    {
      "energy": -24928.988079620565,
      "forces": [
        [
          5.986866327767053e-26,
          -0,
          4.793358774739836e-09
        ],
        [
          -5.5105460879652215,
          -1.687118157162773e-16,
          -3.896544503585234
        ],
        [
          -1.6871181560402357e-16,
          5.510546083954952,
          3.8965445011894695
        ],
        [
          1.6871181555912208e-16,
          -5.510546083954952,
          3.8965445011894695
        ],
        [
          5.5105460879652215,
          1.6871181569382656e-16,
          -3.896544503585234
        ]
      ],
      "positions": [
        [
          -0.00033535501338896264,
          0.00019445851368473266,
          2.4237757553582465e-05
        ],
        [
          0.6198538248125506,
          0.6278348427332795,
          0.6239256873947338
        ],
        [
          0.629712057317103,
          -0.6224794257325066,
          -0.6243498978544924
        ],
        [
          -0.6269958401692594,
          0.6211775190324442,
          -0.6270127770904208
        ],
        [
          -0.62096242721796,
          -0.6273395871195871,
          0.6219763739596431
        ]
      ],
      "step": 5,
      "time_ps": 0.0025,
      "velocities": [
        [
          -0.08505623269218049,
          0.0635349711730197,
          -0.07625540126471884
        ],
        [
          -7.336083588728951,
          -0.21854107041845863,
          -3.2148244014660246
        ],
        [
          -1.2939889931331372,
          5.1978773885575515,
          3.516200754548088
        ],
        [
          2.4099191252155903,
          -6.057149550284622,
          2.752270573591639
        ],
        [
          7.344574321711881,
          1.5567232320490358,
          -4.60274534287386
        ]
      ]
    }
  ]
}
(MMDFLED-Server) mak@DESKTOP-V7E8UM6:/mnt/e/MMDFLED$ 

```